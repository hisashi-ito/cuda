### Random Walk with Restart (RWR) CUDA実装  
レコメンドエンジンとして利用されることが多い Random Walk with Restart アルゴリズムの CUDA実装。  
本プログラムはCOO格納形式で保存された遷移行列と推薦元を表す特徴ベクトルを読み込み当該特徴ベクトルに対応した固有ベクトルを求める。プログラムのCUDAによる実装である。  

CUDAで利用したlibraryとしては cuSPARSE Level2のライブラリである空疎行列と密ベクトルの掛け算のライブラリを利用して実装を行った。その他、ホスト,デバイス側のメモリ管理を簡略化するためにThrustライブラリを利用している。

##### コンパイル方法
```
$ cd bin 
$ make
```
※ 実行環境に nvcc および、 cuSPARSEがインストールされていることを想定とします。

##### 実行方法
```
$ ./rwr -i <遷移行列> (COO格納形式) -v <初期ベクトルファイル> -a <rwrのalphaパラメータ> -t <iteratoin回数> -o <出力ファイル>
```
##### ファイルフォーマット
1. 遷移行列(COO格納形式)  
計算で利用する遷移行列をCOO形式で保存する。フィールドセパレータはカンマ','文字列とする
```
0,0,1.0
0,1,2.0
0,2,3.0
1,0,4.0
1,1,5.0
1,2,6.0
2,0,7.0
2,1.8.0
2,2,9.0
```
2. 初期ベクトルファイル(推薦元ベクトル)  
推薦元となる情報を表現した特徴ベクトルのリストを与える。２つの推薦データを作成するのであれば以下のように２行で表現する。本質的に推薦元ベクトルは密ベクトルである。ファイルセパレーターは ',' カンマとする。
```
0.1,0.2,0.3
0,0.4,0.8
```
3. rwrのαパラメータ  
rwrを計算するときにハイパーパラメータ。0から1までのdoubleで指定する。alphaが小さいと推薦自のパーソナライズ効果が強くなる。逆に大きいと人気度が高いものが出力される。  

4. iteration回数  
べき乗法でベクトルを乗算する回数。上記のαパラメータと関連があるが、１０〜２０程度でよい。  

5. 出力ファイル  
以下の形式で出力する。それぞれの固有ベクトルの値が出力される。
```
0.0502512,0.890931,0.45135　# 1つ目のデータの固有ベクトル
0.141171,0.819256,0.555779  # 2つ目のデータの固有ベクトル
```
##### 補足  
環境によってはcuSPARSEライブラリにライブラリパスが通ってないかもしれませんのでその場合は環境設定で以下の設定を実施しておく。
```
LD_LIBRARY_PATH=/usr/local/lib:/usr/lib:/usr/local/cuda-7.5/lib64;
export LD_LIBRARY_PATH
```
